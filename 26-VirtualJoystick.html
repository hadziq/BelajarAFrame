<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Joystick Virtual</title>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <style>
        .button{
            width: 100px; height: 100px;
            position: absolute; z-index: 2;
        }
    </style>
</head>
<body>
    <img id="up" src="images/up.png" class="button" style=" bottom: 120px; left: 120px;">
    <img id="down" src="images/down.png" class="button" style=" bottom: 20px; left: 120px;">
    <img id="left" src="images/left.png" class="button" style=" bottom: 20px; left: 20px;">
    <img id="right" src="images/right.png" class="button" style=" bottom: 20px; left: 220px;">
    <script>
        let direction = new THREE.Vector3();

        function clickListener(ev) {
            let cam = document.querySelector("#cam");
            let position = cam.getAttribute("position");
            let sceneEl = document.querySelector("#scene1");
            let camDirection = sceneEl.camera.getWorldDirection(direction);
            camDirection.multiplyScalar(0.4);
            if (ev.srcElement.id == "up") {
                console.log("%cUP", "font-size:2em;");
                position.x += camDirection.x;
                position.z += camDirection.z;
            } else if (ev.srcElement.id == "down"){
                console.log("%cDOWN", "font-size:2em;");
                position.x -= camDirection.x;
                position.z -= camDirection.z;
            }
            let sideDirection = camDirection.cross(new THREE.Vector3(0, 1, 0));
            if (ev.srcElement.id == "left") {
                console.log("%cLEFT", "font-size:2em;");
                position.x -= sideDirection.x;
                position.z -= sideDirection.z;
            } else if (ev.srcElement.id == "right"){
                console.log("%cRIGHT", "font-size:2em;");
                position.x += sideDirection.x;
                position.z += sideDirection.z;
            }
            cam.setAttribute("position", position);
        }
        AFRAME.registerComponent("user-control", {
            init:function() {
                let up = document.querySelector("#up");
                let down = document.querySelector("#down");
                let left = document.querySelector("#left");
                let right = document.querySelector("#right");
                up.addEventListener("click", clickListener);
                down.addEventListener("click", clickListener);
                left.addEventListener("click", clickListener);
                right.addEventListener("click", clickListener);
            }
        });
    </script>
    <a-scene id="scene1" user-control>
        <a-entity
            id="cam"
            camera look-controls wasd-controls
            position="0 1.5 3"
        ></a-entity>
        <!-- hal di atas sama dengan tag a-camera -->
        <a-gltf-model src="models/Pokescene.gltf"></a-gltf-model>
    </a-scene>
</body>
</html>